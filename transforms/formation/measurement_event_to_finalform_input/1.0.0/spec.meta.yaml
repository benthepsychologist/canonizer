id: formation/measurement_event_to_finalform_input
version: 1.0.0
engine: jsonata
runtime: node
extensions: []

from_schema: iglu:org.canonical/measurement_event/jsonschema/1-0-0
to_schema: iglu:org.canonical/finalform_input/jsonschema/1-0-0

spec_path: spec.jsonata

checksum:
  jsonata_sha256: "9bf5ba0cf033b844573a9c9f3372aa54a60896cdb9c43a60ce0d65b6f023dee2"

provenance:
  author: "Ben Machina <ben@therapyai.com>"
  created_utc: "2026-02-04T00:00:00+00:00"

status: stable

description: >
  Transform measurement_events row into the input dict expected by the finalform scoring callable.
  Extracts answers from metadata and formats them as items array.
  Used by formation pipeline Stage 2.

config_schema:
  required:
    - instrument
  properties:
    instrument:
      type: string
      description: "Instrument identifier (e.g., intake_01, phq9)"

tests:
  - input: tests/input.json
    expect: tests/expected.json
